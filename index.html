<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Verification</title>
    <script>
        // Initialize the list with example entries
        const exampleList = ["ligmajuicypuicy", "example1@example.com", "example2@example.com", "example3@example.com"];

        function isEmailInList(email) {
            // Convert the input email to lowercase and check against each list item in lowercase
            return exampleList.some(item => item.toLowerCase() === email.toLowerCase());
        }

        async function processEmail(email) {
            // Check if the email is in the example list, ignoring case
            const result = isEmailInList(email);

            try {
                // Send the result back to the C# application
                const response = await fetch("http://localhost:8080/", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ result: result })
                });
                if (!response.ok) {
                    console.error("Failed to send data to the server:", response.statusText);
                    displayMessage("Error: Could not verify email.");
                    return;
                }
            } catch (error) {
                console.error("Error sending data to the server:", error);
                displayMessage("Error: Could not verify email.");
                return;
            }

            // Display result message
            displayMessage(result ? "Email is verified!" : "Email not found.");
        }

        function displayMessage(message) {
            const messageDiv = document.getElementById("resultMessage");
            messageDiv.textContent = message;
        }

        // Get the email parameter from the URL and process it
        const urlParams = new URLSearchParams(window.location.search);
        const email = urlParams.get('email');
        if (email) {
            processEmail(email);
        } else {
            console.error("No email parameter provided in the URL");
            displayMessage("No email parameter provided in the URL.");
        }
    </script>
</head>
<body>
    <div id="resultMessage" style="font-size: 1.2em; margin-top: 20px; text-align: center;"></div>
</body>
</html>
