<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blank Page</title>
</head>
<body>

<script>
    // Function to get the full URL
    function getFullUrl() {
        try {
            return window.location.href;
        } catch (error) {
            console.error(error);
            return null;
        }
    }

    // Function to send the URL to the WinForms application
    function sendUrlToWinForms(url) {
        // Trigger WndProc with a custom message
        const WM_SHOWME = 0x18;
        const hwnd = window.external ? window.external.Handle : null; // Use window.external.Handle if available
        if (hwnd) {
            const message = {
                Msg: WM_SHOWME,
                LParam: url,
            };
            SendMessage(hwnd, 'WM_SHOWME', message);
        }
    }

    // Call the function when the page has fully loaded
    window.onload = function() {
        const fullUrl = getFullUrl();

        if (fullUrl) {
            // Convert the URL to a string and pass it to the WinForms application
            sendUrlToWinForms(fullUrl);
        } else {
            console.error('Failed to get the full URL');
        }
    };

    // Helper function to send a message to WndProc
    function SendMessage(hwnd, message, data) {
        try {
            window.external.SendMessage(hwnd, message, data);
        } catch (error) {
            console.error('Error sending message:', error);
        }
    }
</script>

</body>
</html>
